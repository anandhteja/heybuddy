{% load static %}  



<!DOCTYPE html>
<html style="font-size: 16px;">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="Hey Buddy">
    <meta name="description" content="">
    <meta name="page_type" content="np-template-header-footer-from-plugin">
    <title>Chat</title>
    <style>

        div.sender{color:black;margin-left:60%;border: 2px solid black;border-radius:10px ;background-color:lightgreen;padding-left: 5px;}
        div.receive{margin-right:60%;color:white;border: 2px solid black;border-radius:10px ;background-color:cadetblue;padding-left: 5px;}
       
     
        body {
 background-image: url("{{background.image.url}}"); background-repeat: no-repeat;background-attachment: fixed;background-position: center;
 
}
body:before {
    content: "";
    display: block;
    position: fixed;
    width: 100%;
    height: 100%;
    left: 0;
    top: 0;
    z-index: -1;
    background-color: rgba(255, 255, 255, 0.1);
}



.input {
  position: fixed;
  left: 0;
  bottom: 0;
  width: 100%;
  background-color:cornflowerblue;
  color:black;
  text-align: center;
}

h1.receive{color:darkslateblue}


div.block{margin-left:80%}
div.basenav{position: fixed;
left: 0;
bottom: 0;
width: 100%;background-color:mintcream}
</style>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
 
    <link rel="stylesheet" href="{% static "chat/nicepage.css" %}" media="screen">
    <link rel="stylesheet" href="{% static "chat/Home.css" %}" media="screen">
        <script class="u-script" type="text/javascript" src="{% static "chat/jquery.js" %}" defer=""></script>
        <script class="u-script" type="text/javascript" src="{% static "chat/nicepage.js" %}" defer=""></script>
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i">
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "",
		"logo": "images/heybuddy.png"
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="Home">
    <meta property="og:type" content="website">
    </head> 





  
<body>
  <nav class="navbar navbar-light bg-light">
    <div class="container-fluid">
      <a class="navbar-brand" href="/">
        <img src="{% static "images/heybuddy.png" %}" alt="" width="30" height="24" class="d-inline-block align-text-top">
        {{receiver.username}}
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/discover/">Discover</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              My account
            </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item" href="/mypr/">My profile</a></li>
              <li><a class="dropdown-item" href="/notifications/">Notifications</a></li>
              <li><a class="dropdown-item" href="/chathome/">Chats</a></li>
              
            </ul>
          </li>
          
        </ul>
        <form class="d-flex" method="get", action='/searchbox/'>
          <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search" name=username>
          <button class="btn btn-outline-success" type="submit">Search</button>
          {% csrf_token %}
        </form>
      </div>
    </div>
  </nav>

  {% for msg in messages %}
  

  <div class="alert alert-warning alert-dismissible fade show" role="alert">
    <strong>Done!</strong> {{msg}}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>

  {% endfor %}


  
    <button onClick="window.location.reload();">refresh</button>

    {% if receiver.username not in block %}
    <div class="block">
      <form method="post" action="/blockchatuser/" enctype="multipart/form-data">
        <input type="hidden" name='blocked_user' value={{receiver.username}}>
        <input type="hidden" name='blocked_by' value={{usern}}>
      <button type="submit">block</button>
      {% csrf_token %}
    </form>
    </div>
    {% else %}  
    <div class="block">
      <form method="post" action="/unblockchatuser/" enctype="multipart/form-data">
        <input type="hidden" name='blocked_user' value={{receiver.username}}>
        <input type="hidden" name='blocked_by' value={{usern}}>
      <button type="submit">unblock</button>
      {% csrf_token %}
    </form>
    </div>

    {% endif %}  



    <h1 class=receive><a href="/usp/{{receiver.username}}">{{receiver.username}}</h1></a>
     
    

    <br/>
    
   
    
    {% for c in chat  %}
    
      
    
    {% if c.sender == receiver.username and c.receiver == user.username %}
    
    <div class='receive'>
      {% if c.message %}

    {{c.sender}} :<br/>&nbsp;&nbsp;{{c.message}} &nbsp;-&nbsp;<u style="font-size: 10px;">{{c.uploaded_on}}</u>

    {% endif %}
    <br/>
  
    {% if c.chat_photos %}

    {{c.sender}} :<br/>&nbsp;&nbsp;<a href="{{c.chat_photos.url}}" target="_blank"><img src="{{c.chat_photos.url}}" width=100 height=150></a> &nbsp;-&nbsp;<u style="font-size: 10px;">{{c.uploaded_on}}</u>

    {% endif %}
  </div>
    
    {% endif %}
    
    <br/>
    
    
    {% if c.sender == user.username and c.receiver == receiver.username %}
    
    <div class='sender'>
      {% if c.message %}
    
  me: &nbsp;&nbsp;{{c.message}} &nbsp;-&nbsp;<u style="font-size: 10px;">{{c.uploaded_on}}</u>
<div class="tej"><button class="tej" type ="submit"><a href="/deletemymessage/{{c.id}}/">delete</a></button></div>
  {% endif %}



  {% if c.chat_photos %}
    
  me: &nbsp;&nbsp;<a href="{{c.chat_photos.url}}" target="_blank"><img src="{{c.chat_photos.url}}" width=100 height=150></a> &nbsp;-&nbsp;<u style="font-size: 10px;">{{c.uploaded_on}}</u>
<div class="tej"><button class="tej" type ="submit"><a href="/deletemymessage/{{c.id}}/">delete</a></button></div>
  {% endif %}





</div>



    
    {% endif %}
    
      <br/>
    
   
      
{% endfor %}
   <br/><br/>
   
   {% if receiver.username not in block %}

   {% if usern not in block_by %}
     
   
   
      
  
   <div class="input">
<form method='POST' enctype="multipart/form-data" action="/addmessage/">

    <input type=hidden name='receiver' value={{receiver.username}}>
    <input type="text" name='message'>
    {% csrf_token %}
<button type="submit">send</button>
</form>
<form method='POST' enctype="multipart/form-data" action="/chatsendimages/">

  <input type=hidden name='receiver' value={{receiver.username}}>
  <p class="tej" style="font-size:11px"><input type="file" name='image'>
  {% csrf_token %}
<button type="submit">send</button></p>
</form>
</div>
{% else %}  
<div class="input">
<h4 style="color:darkred;">you were blocked by this user</h4>
</div>




{% endif %}
{% else %}  
<div class="input">
<h4 style="color:darkred;">you blocked  this user</h4>
</div>

{% endif %}






<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    


</body>
</html>